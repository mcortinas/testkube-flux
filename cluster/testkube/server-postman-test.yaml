---
apiVersion: tests.testkube.io/v3
kind: Test
metadata:
  name: postman-collection
  namespace: testkube
spec:
  type: postman/collection
  content:
    type: string
    data: "{\n  \"_\": {\n    \"postman_id\": \"be6c83aa-6170-43d1-a000-c296aa8c42a5\"\n  },\n  \"item\": [\n    {\n      \"id\": \"27e81e1b-d425-4f60-b01b-7630092e6f3f\",\n      \"name\": \"/\",\n      \"request\": {\n        \"name\": \"/\",\n        \"description\": {\n          \"type\": \"text/plain\"\n        },\n        \"url\": {\n          \"path\": [\n            \"\"\n          ],\n          \"host\": [\n            \"{{baseUrl}}\"\n          ],\n          \"query\": [],\n          \"variable\": []\n        },\n        \"header\": [\n          {\n            \"key\": \"Accept\",\n            \"value\": \"application/json\"\n          }\n        ],\n        \"method\": \"GET\"\n      },\n      \"response\": [\n        {\n          \"_\": {\n            \"postman_previewlanguage\": \"json\"\n          },\n          \"id\": \"d26c9606-4dca-41ea-9160-6342c85b6b1d\",\n          \"name\": \"OK\",\n          \"originalRequest\": {\n            \"url\": {\n              \"path\": [\n                \"\"\n              ],\n              \"host\": [\n                \"{{baseUrl}}\"\n              ],\n              \"query\": [],\n              \"variable\": []\n            },\n            \"method\": \"GET\",\n            \"body\": {}\n          },\n          \"status\": \"OK\",\n          \"code\": 200,\n          \"header\": [\n            {\n              \"key\": \"Content-Type\",\n              \"value\": \"application/json\"\n            }\n          ],\n          \"body\": \"{\\n  \\\"message\\\": \\\"Hello World!\\\"\\n}\",\n          \"cookie\": []\n        }\n      ],\n      \"event\": [\n        {\n          \"listen\": \"test\",\n          \"script\": {\n            \"id\": \"1fe16e84-9385-4ac0-9c70-f4fb4671404f\",\n            \"type\": \"text/javascript\",\n            \"exec\": [\n              \"// Validate status 2xx \\npm.test(\\\"[GET]::/ - Status code is 2xx\\\", function () {\\n   pm.response.to.be.success;\\n});\\n\",\n              \"// Validate if response header has matching content-type\\npm.test(\\\"[GET]::/ - Content-Type is application/json\\\", function () {\\n   pm.expect(pm.response.headers.get(\\\"Content-Type\\\")).to.include(\\\"application/json\\\");\\n});\\n\",\n              \"// Validate if response has JSON Body \\npm.test(\\\"[GET]::/ - Response has JSON Body\\\", function () {\\n    pm.response.to.have.jsonBody();\\n});\\n\",\n              \"// Response Validation\\nconst schema = {\\\"type\\\":\\\"object\\\",\\\"properties\\\":{\\\"message\\\":{\\\"type\\\":\\\"string\\\",\\\"example\\\":\\\"Hello World!\\\"}}}\\n\\n// Validate if response matches JSON schema \\npm.test(\\\"[GET]::/ - Schema is valid\\\", function() {\\n    pm.response.to.have.jsonSchema(schema,{unknownFormats: [\\\"int32\\\", \\\"int64\\\", \\\"float\\\", \\\"double\\\"]});\\n});\\n\"\n            ]\n          }\n        }\n      ]\n    }\n  ],\n  \"event\": [],\n  \"variable\": [\n    {\n      \"type\": \"string\",\n      \"value\": \"http://localhost:3000\",\n      \"key\": \"baseUrl\"\n    }\n  ],\n  \"info\": {\n    \"_postman_id\": \"be6c83aa-6170-43d1-a000-c296aa8c42a5\",\n    \"name\": \"Server API\",\n    \"schema\": \"https://schema.getpostman.com/json/collection/v2.1.0/collection.json\",\n    \"description\": {\n      \"content\": \"\",\n      \"type\": \"text/plain\"\n    }\n  }\n}"
  executionRequest:
    argsMode: append
